/*! litegraph 29-04-2015 */
function LGraph1ParamNode(){this.addOutput("result","",this.getOutputTypes(),this.getOutputExtraInfo()),this.addInput("A","",this.getInputTypes(),this.getInputExtraInfo()),this.shader_piece=LiteGraph.CodeLib[this.getCodeName()]}function LGraph2ParamNode(){this.addOutput("Result","",this.getOutputTypes(),this.getOutputExtraInfo()),this.addInput("A","",this.getInputTypesA(),this.getInputExtraInfoA()),this.addInput("B","",this.getInputTypesB(),this.getInputExtraInfoB()),this.shader_piece=LiteGraph.CodeLib[this.getCodeName()]}function LGraph3ParamNode(){this.addOutput("Result","",this.getOutputTypes(),this.getOutputExtraInfo()),this.addInput("A","",this.getInputTypesA(),this.getInputExtraInfoA()),this.addInput("B","",this.getInputTypesB(),this.getInputExtraInfoB()),this.addInput("C","",this.getInputTypesC(),this.getInputExtraInfoC()),this.shader_piece=LiteGraph.CodeLib[this.getCodeName()]}function LGraphConstColor(){this.addOutput("color","vec4",{vec4:1}),this.properties={color:"#ffffff"},this.editable={property:"value",type:"vec4"},this.boxcolor=this.properties.color,this.shader_piece=new PConstant("vec4")}function LGraphConstant(){this.addOutput("value","float",{"float":1}),this.properties={value:1},this.editable={property:"value",type:"float"},this.shader_piece=new PConstant("float")}function LGraphTime(){this.addOutput("time","float",{"float":1}),this.shader_piece=PTime}function LGraphConstVec2(){this.addOutput("value","vec2",{vec2:1}),this.properties={v1:1,v2:1},this.shader_piece=new PConstant("vec2")}function LGraphConstVec3(){this.addOutput("value","vec3",{vec3:1}),this.properties={v1:1,v2:1,v3:1},this.editable={property:"value",type:"vec3"},this.shader_piece=new PConstant("vec3")}function LGraphConstVec4(){this.addOutput("value","vec4",{vec4:1}),this.properties={v1:1,v2:1,v3:1,v4:1},this.editable={property:"value",type:"vec4"},this.shader_piece=new PConstant("vec4")}function LGraphCamToPixelWS(){this.addOutput("Camera To Pixel","vec3",{vec3:1}),this.shader_piece=PCameraToPixelWS}function LGraphDepth(){this.addOutput("float","float",{"float":1}),this.shader_piece=PDepth}function LGraphPixelNormalWS(){this.addOutput("Pixel Normal","vec3",{vec3:1}),this.shader_piece=PPixelNormalWS}function LGraphUVs(){this.addOutput("UVs","vec2",{vec2:1}),this.properties={UTiling:1,VTiling:1},this.options={UTiling:{step:.01},VTiling:{step:.01}},this.shader_piece=PUVs}function LGraphVertexPosWS(){this.addOutput("vec3","vec3",{vec3:1}),this.shader_piece=PVertexPosWS}function LGraphShader(){this.uninstantiable=!0,this.clonable=!1,this.addInput("albedo","vec3",{vec3:1,vec4:1}),this.addInput("normal","vec3",{vec3:1,vec4:1}),this.addInput("emission","vec3",{vec3:1,vec4:1}),this.addInput("specular","float",{"float":1}),this.addInput("gloss","float",{"float":1}),this.addInput("alpha","float",{"float":1}),this.addInput("alpha clip","float",{"float":1}),this.addInput("refraction","float",{"float":1}),this.addInput("vertex offset","float",{"float":1}),this.size=[125,250],this.shader_piece=ShaderConstructor}function LGraphCompsToVec(){this.output_array_types=["","float","vec2","vec3","vec4"],this.output_array_index=0,this.addOutput("result",""),this.addInput("x","",{"float":1}),this.addInput("y","",{"float":1}),this.addInput("z","",{"float":1}),this.addInput("v","",{"float":1}),this.shader_piece=new PConstant("vec4")}function LGraphTexturePreview(){this.addInput("Texture","Texture",{Texture:1,Vec3:1,Vec4:1}),this.properties={flipY:!1},this.size=[LGraphTexture.image_preview_size,LGraphTexture.image_preview_size]}function LGraphTexture(){this.addOutput("Texture","Texture",{Texture:1}),this.addOutput("Color","vec4",{vec4:1}),this.addOutput("R","float",{"float":1}),this.addOutput("G","float",{"float":1}),this.addOutput("B","float",{"float":1}),this.addOutput("A","float",{"float":1}),this.addInput("UVs","vec2",{vec2:1}),this.properties=this.properties||{},this.properties.name="",this.properties.texture_url="",this.properties.texture_type="Color",this.properties.normal_map_type="Tangent space",this.options=this.options||{},this.options.texture_url={hidden:1};this.options.texture_type={multichoice:["Color","Normal map"],reloadonchange:1,callback:"toggleNormalMap"},this.options.normal_map_type={multichoice:["Tangent space","Model space","Bump map"],hidden:1},this.size=[170,165],this.shader_piece=PTextureSample,this.uvs_piece=PUVs}function LGraphCubemap(){this.addOutput("Cubemap","Cubemap"),this.addOutput("Color","vec4",{vec4:1}),this.addInput("vec3","vec3"),this.properties=this.properties||{},this.properties.name="",this.properties=this.properties||{},this.properties.name="",this.properties.texture_url="",this.options={texture_url:{hidden:1}},this.size=[LGraphTexture.image_preview_size,LGraphTexture.image_preview_size],this.shader_piece=PTextureSampleCube,this.vector_piece=new PReflected,this.size=[170,165]}function LGraphVecToComps(){this.addInput("vec","",{vec4:1,vec3:1,vec2:1}),this.addOutput("x","",{"float":1}),this.addOutput("y","",{"float":1}),this.addOutput("z","",{"float":1}),this.addOutput("v","",{"float":1})}function LGraphVecToVec(){this.addInput("vec","",null,{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1}),this.addOutput("number","float",{"float":1}),this.addOutput("vec2","vec2",{vec2:1}),this.addOutput("vec3","vec3",{vec3:1}),this.addOutput("vec4","vec4",{vec4:1}),this.shader_piece=new PVecToVec}function LGraphAbs(){this._ctor(LGraphAbs.title),this.code_name="abs",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_types=null,this.in_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},LGraph1ParamNode.call(this)}function LGraphCos(){this._ctor(LGraphCos.title),this.code_name="cos",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_types=null,this.in_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},LGraph1ParamNode.call(this)}function LGraphExp(){this._ctor(LGraphExp.title),this.code_name="exp2",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_types=null,this.in_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},LGraph1ParamNode.call(this)}function LGraphFrac(){this._ctor(LGraphFrac.title),this.code_name="fract",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_types=null,this.in_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},LGraph1ParamNode.call(this)}function LGraphSin(){this._ctor(LGraphSin.title),this.code_name="sin",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_types=null,this.in_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},LGraph1ParamNode.call(this)}function LGraphOperation(){this.output_types=this.output_types||null,this.out_extra_info=this.out_extra_info||{types_list:{"float":1},use_t:1},this.intput_typesA=this.intput_typesA||null,this.in_extra_infoA=this.in_extra_infoA||{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesB=this.intput_typesB||null,this.in_extra_infoB=this.in_extra_infoB||{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.number_piece=new PConstant("float"),this.properties={A:0,B:0},LGraph2ParamNode.call(this)}function LGraphAddOp(){this._ctor(LGraphAddOp.title),this.code_name="add",LGraphOperation.call(this)}function LGraphClamp(){this._ctor(LGraphClamp.title),this.code_name="clamp",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesA=null,this.in_extra_infoA={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesB=null,this.in_extra_infoB={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesC=null,this.in_extra_infoC={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.properties={min:0,max:1.5},this.number_piece=new PConstant("float"),LGraph3ParamNode.call(this)}function LGraphDivOp(){this._ctor(LGraphDivOp.title),this.code_name="div",LGraphOperation.call(this)}function LGraphDot(){this._ctor(LGraphDot.title),this.code_name="dot",this.output_types={"float":1},this.out_extra_info={},LGraphOperation.call(this)}function LGraphFresnel(){this.addOutput("result","float",{"float":1}),this.addInput("normal","vec3",{vec3:1,vec4:1}),this.addInput("exp","float",{"float":1}),this.shader_piece=new PFresnel}function LGraphIf(){this._ctor(LGraphIf.title),this.addOutput("result","",null,{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1}),this.addInput("A","float",{"float":1,vec4:1,vec3:1,vec2:1}),this.addInput("B","float",{"float":1,vec4:1,vec3:1,vec2:1}),this.addInput("A>B","",null,{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1}),this.addInput("A<B","",null,{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1}),this.addInput("A==B","",null,{types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1}),this.shader_piece=new PIf}function LGraphMix(){this._ctor(LGraphMix.title),this.code_name="mix",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesA=null,this.in_extra_infoA={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesB=null,this.in_extra_infoB={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesC=null,this.in_extra_infoC={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.properties={alpha:.5},this.options={alpha:{min:0,max:1,step:.01}},this.number_piece=new PConstant("float"),LGraph3ParamNode.call(this)}function LGraphMulOp(){this._ctor(LGraphMulOp.title),this.code_name="mul",LGraphOperation.call(this)}function LGraphPanner(){this.addOutput("output","",{vec2:1}),this.addInput("coordinate","",{vec2:1}),this.addInput("time","",{"float":1}),this.properties={SpeedX:1,SpeedY:1},this.options={SpeedX:{min:-1,max:1,step:.001},SpeedY:{min:-1,max:1,step:.001}},this.shader_piece=new PPanner,this.uvs_piece=PUVs}function LGraphPow(){this._ctor(LGraphPow.title),this.code_name="pow",LGraphOperation.call(this),this.inputs[0].label="Value",this.inputs[1].label="Exp"}function LGraphReflect(){this.addOutput("reflect vector","vec3",{vec3:1}),this.addInput("normal","vec3",{vec3:1}),this.addInput("vector","vec3",{vec3:1}),this.shader_piece=LiteGraph.CodeLib.reflect}function LGraphSmooth(){this._ctor(LGraphSmooth.title),this.code_name="smoothstep",this.output_types=null,this.out_extra_info={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesA=null,this.in_extra_infoA={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesB=null,this.in_extra_infoB={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.intput_typesC=null,this.in_extra_infoC={types_list:{"float":1,vec3:1,vec4:1,vec2:1},use_t:1},this.properties={lower:0,upper:1.5},this.number_piece=new PConstant("float"),LGraph3ParamNode.call(this)}function LGraphSubOp(){this._ctor(LGraphSubOp.title),this.code_name="sub",LGraphOperation.call(this)}LGraph1ParamNode.prototype.constructor=LGraph1ParamNode,LGraph1ParamNode.prototype.onExecute=function(){},LGraph1ParamNode.prototype.processInputCode=function(a){var b=this.getInputCode(0);if(b){var c=this.codes[0]=this.shader_piece.getCode({out_var:this.getCodeName()+"_"+this.id,a:b.getOutputVar(),scope:a,out_type:this.getOutputType(),order:this.order});c.merge(b)}},LGraph1ParamNode.prototype.getOutputType=function(){var a=this.output_types?this.output_types:this.T_out_types,b=LiteGraph.getOtputTypeFromMap(a);return b},LGraph1ParamNode.prototype.getOutputTypes=function(){return this.output_types?this.output_types:this.T_out_types},LGraph1ParamNode.prototype.getInputTypes=function(){return this.intput_types?this.intput_types:this.T_in_types},LGraph1ParamNode.prototype.getScope=function(){return CodePiece.FRAGMENT},LGraph1ParamNode.prototype.getCodeName=function(){return this.code_name},LGraph1ParamNode.prototype.getInputExtraInfo=function(){return this.in_extra_info},LGraph1ParamNode.prototype.getOutputExtraInfo=function(){return this.out_extra_info},LGraph2ParamNode.prototype.constructor=LGraph2ParamNode,LGraph2ParamNode.prototype.onExecute=function(){},LGraph2ParamNode.prototype.processInputCode=function(a){var b=LiteGraph.EMPTY_CODE,c=this.getInputCode(0)||this.onGetNullCode(0,a),d=this.getInputCode(1)||this.onGetNullCode(1,a);c&&d&&(b=this.codes[0]=this.shader_piece.getCode({out_var:this.getCodeName()+"_"+this.id,a:c.getOutputVar(),b:d.getOutputVar(),scope:a,out_type:this.getOutputType(),order:this.order}),b.merge(c),b.merge(d))},LGraph2ParamNode.prototype.getOutputTypes=function(){return this.output_types?this.output_types:this.T_out_types},LGraph2ParamNode.prototype.getInputTypesA=function(){return this.intput_typesA?this.intput_typesA:this.T_in_types},LGraph2ParamNode.prototype.getInputTypesB=function(){return this.intput_typesB?this.intput_typesB:this.T_in_types},LGraph2ParamNode.prototype.getOutputType=function(){var a=this.output_types?this.output_types:this.T_out_types,b=LiteGraph.getOtputTypeFromMap(a);return b},LGraph2ParamNode.prototype.getScope=function(){return CodePiece.FRAGMENT},LGraph2ParamNode.prototype.getCodeName=function(){return this.code_name},LGraph2ParamNode.prototype.getInputExtraInfoA=function(){return this.in_extra_infoA},LGraph2ParamNode.prototype.getInputExtraInfoB=function(){return this.in_extra_infoB},LGraph2ParamNode.prototype.getOutputExtraInfo=function(){return this.out_extra_info},LGraph3ParamNode.prototype.constructor=LGraph3ParamNode,LGraph3ParamNode.prototype.onExecute=function(){},LGraph3ParamNode.prototype.processInputCode=function(a){var b=LiteGraph.EMPTY_CODE,c=this.getInputCode(0)||this.onGetNullCode(0,a),d=this.getInputCode(1)||this.onGetNullCode(1,a),e=this.getInputCode(2)||this.onGetNullCode(2,a);c&&d&&e&&(b=this.codes[0]=this.shader_piece.getCode({out_var:this.getCodeName()+"_"+this.id,a:c.getOutputVar(),b:d.getOutputVar(),c:e.getOutputVar(),scope:a,out_type:this.getOutputType(),order:this.order}),b.setOrder(this.order),e&&b.merge(e),b.merge(c),b.merge(d))},LGraph3ParamNode.prototype.getOutputTypes=function(){return this.output_types?this.output_types:this.T_out_types},LGraph3ParamNode.prototype.getInputTypesA=function(){return this.intput_typesA?this.intput_typesA:this.T_in_types},LGraph3ParamNode.prototype.getInputTypesB=function(){return this.intput_typesB?this.intput_typesB:this.T_in_types},LGraph3ParamNode.prototype.getInputTypesC=function(){return this.intput_typesC?this.intput_typesC:this.T_in_types},LGraph3ParamNode.prototype.getOutputType=function(){var a=this.output_types?this.output_types:this.T_out_types,b=LiteGraph.getOtputTypeFromMap(a);return b},LGraph3ParamNode.prototype.getScope=function(){return CodePiece.FRAGMENT},LGraph3ParamNode.prototype.getCodeName=function(){return this.code_name},LGraph3ParamNode.prototype.getInputExtraInfoA=function(){return this.in_extra_infoA},LGraph3ParamNode.prototype.getInputExtraInfoB=function(){return this.in_extra_infoB},LGraph3ParamNode.prototype.getInputExtraInfoC=function(){return this.in_extra_infoC},LGraph3ParamNode.prototype.getOutputExtraInfo=function(){return this.out_extra_info},LGraphConstColor.title="Color",LGraphConstColor.desc="Constant color",LGraphConstColor.prototype.onDrawBackground=function(){},LGraphConstColor.prototype.onExecute=function(){this.bgcolor=this.properties.color},LGraphConstColor.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({out_var:"vec4_"+this.id,a:LiteGraph.hexToColor(this.properties.color),scope:a,order:this.order})},LiteGraph.registerNodeType("constants/"+LGraphConstColor.title,LGraphConstColor),LGraphConstant.title="Number",LGraphConstant.desc="Constant value",LGraphConstant.prototype.setValue=function(a){"string"==typeof a&&(a=parseFloat(a)),this.properties.value=a,this.setDirtyCanvas(!0)},LGraphConstant.prototype.onExecute=function(){this.setOutputData(0,parseFloat(this.properties.value))},LGraphConstant.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({out_var:"float_"+this.id,a:this.properties.value.toFixed(3),scope:a,order:this.order})},LGraphConstant.prototype.onDrawBackground=function(){this.outputs[0].label=this.properties.value.toFixed(3)},LGraphConstant.prototype.onWidget=function(a,b){"value"==b.name&&this.setValue(b.value)},LiteGraph.registerNodeType("constants/"+LGraphConstant.title,LGraphConstant),LGraphTime.title="Time",LGraphTime.desc="Time since execution started",LGraphTime.prototype.onExecute=function(){},LGraphTime.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({order:this.order,scope:a})},LiteGraph.registerNodeType("constants/"+LGraphTime.title,LGraphTime),LGraphConstVec2.title="ConstVec2",LGraphConstVec2.desc="Constant vector2",LGraphConstVec2.prototype.setFloatValue=function(a,b){"string"==typeof b&&(b=parseFloat(b)),a=b},LGraphConstVec2.prototype.setValue=function(a,b){this.setFloatValue(this.properties.v1,a),this.setFloatValue(this.properties.v2,b),this.setDirtyCanvas(!0)},LGraphConstVec2.prototype.onExecute=function(){},LGraphConstVec2.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({out_var:"vec2_"+this.id,a:this.valueToString(),scope:a,order:this.order})},LGraphConstVec2.prototype.onDrawBackground=function(){this.outputs[0].label=this.valueToString()},LGraphConstVec2.prototype.valueToString=function(){return"vec2("+this.properties.v1.toFixed(3)+","+this.properties.v2.toFixed(3)+")"},LiteGraph.registerNodeType("constants/"+LGraphConstVec2.title,LGraphConstVec2),LGraphConstVec3.title="ConstVec3",LGraphConstVec3.desc="Constant vector3",LGraphConstVec3.prototype.setFloatValue=function(a,b){"string"==typeof b&&(b=parseFloat(b)),a=b},LGraphConstVec3.prototype.setValue=function(a,b,c){this.setFloatValue(this.properties.v1,a),this.setFloatValue(this.properties.v2,b),this.setFloatValue(this.properties.v3,c),this.setDirtyCanvas(!0)},LGraphConstVec3.prototype.onExecute=function(){},LGraphConstVec3.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({out_var:"vec3_"+this.id,a:this.valueToString(),scope:a,order:this.order})},LGraphConstVec3.prototype.onDrawBackground=function(){this.outputs[0].label=this.valueToString()},LGraphConstVec3.prototype.valueToString=function(){return"vec3("+this.properties.v1.toFixed(3)+","+this.properties.v2.toFixed(3)+","+this.properties.v3.toFixed(3)+")"},LiteGraph.registerNodeType("constants/"+LGraphConstVec3.title,LGraphConstVec3),LGraphConstVec4.title="ConstVec4",LGraphConstVec4.desc="Constant vector4",LGraphConstVec4.prototype.setFloatValue=function(a,b){"string"==typeof b&&(b=parseFloat(b)),a=b},LGraphConstVec4.prototype.setValue=function(a,b,c,d){this.setFloatValue(this.properties.v1,a),this.setFloatValue(this.properties.v2,b),this.setFloatValue(this.properties.v3,c),this.setFloatValue(this.properties.v4,d),this.setDirtyCanvas(!0)},LGraphConstVec4.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({out_var:"vec4_"+this.id,a:this.valueToString(),scope:a,order:this.order})},LGraphConstVec4.prototype.onExecute=function(){this.processNodePath()},LGraphConstVec4.prototype.onDrawBackground=function(){this.outputs[0].label=this.valueToString()},LGraphConstVec4.prototype.valueToString=function(){return"vec4("+this.properties.v1.toFixed(3)+","+this.properties.v2.toFixed(3)+","+this.properties.v3.toFixed(3)+","+this.properties.v4.toFixed(3)+")"},LiteGraph.registerNodeType("constants/"+LGraphConstVec4.title,LGraphConstVec4),LGraphCamToPixelWS.title="CameraToPixelWS",LGraphCamToPixelWS.desc="The vector from camera to pixel",LGraphCamToPixelWS.prototype.onExecute=function(){this.codes[0]=this.shader_piece.getCode({order:this.order})},LiteGraph.registerNodeType("coordinates/"+LGraphCamToPixelWS.title,LGraphCamToPixelWS),LGraphDepth.title="Depth",LGraphDepth.desc="Depth of the pixel",LGraphDepth.prototype.onExecute=function(){},LGraphDepth.prototype.processInputCode=function(){this.codes[0]=this.shader_piece.getCode({order:this.order})},LiteGraph.registerNodeType("coordinates/"+LGraphDepth.title,LGraphDepth),LGraphPixelNormalWS.title="PixelNormalWS",LGraphPixelNormalWS.desc="The normal in world space",LGraphPixelNormalWS.prototype.onExecute=function(){this.codes[0]=this.shader_piece.getCode({order:this.order})},LiteGraph.registerNodeType("coordinates/"+LGraphPixelNormalWS.title,LGraphPixelNormalWS),LGraphUVs.title="TextureCoords",LGraphUVs.desc="Texture coordinates",LGraphUVs.prototype.onExecute=function(){},LGraphUVs.prototype.processInputCode=function(a){this.codes[0]=this.shader_piece.getCode({order:this.order,utiling:this.properties.UTiling.toFixed(3),vtiling:this.properties.VTiling.toFixed(3),out_var:"uvs_"+this.id,scope:a})},LGraphUVs.prototype.setFloatValue=function(a,b){"string"==typeof b&&(b=parseFloat(b)),a=b},LGraphUVs.prototype.setValue=function(a,b){this.setFloatValue(this.properties.UTiling,a),this.setFloatValue(this.properties.VTiling,b)},LiteGraph.registerNodeType("coordinates/"+LGraphUVs.title,LGraphUVs),LGraphVertexPosWS.title="VertexPositionWS",LGraphVertexPosWS.desc="Vertex position in WS",LGraphVertexPosWS.prototype.onExecute=function(){},LGraphVertexPosWS.prototype.processInputCode=function(){this.codes[0]=this.shader_piece.getCode({order:this.order})},LiteGraph.registerNodeType("coordinates/"+LGraphVertexPosWS.title,LGraphVertexPosWS),LGraphShader.title="Output",LGraphShader.desc="Output Main Node",LGraphShader.prototype.setValue=function(){},LGraphShader.prototype.onExecute=function(){this.processInputCode()},LGraphShader.prototype.onDrawBackground=function(){},LGraphShader.prototype.onWidget=function(){},LGraphShader.prototype.sortPathByOrder=function(a){var b=[];for(var c in a)b.push([c,a[c]]);return b.sort(function(a,b){return a[1].order-b[1].order}),b},LGraphShader.prototype.getFullCode=function(a,b,c){CodePiece.ORDER_MODIFIER=c;for(var d=this.getInputNodePath(a),e=this.sortPathByOrder(d),f=0;f<e.length;++f){var g=e[f][1];g!=this&&g.processInputCode(b)}var h=this.getInputCode(a)||LiteGraph.EMPTY_CODE;return h},LGraphShader.prototype.processInputCode=function(){var a=this.getFullCode(0,CodePiece.FRAGMENT,0),b=this.getFullCode(1,CodePiece.FRAGMENT,1e3);b.getOutputVar()&&b.fragment.setBody("normal = normalize("+b.getOutputVar()+".xyz);\n",-5);for(var c=this.getFullCode(2,CodePiece.FRAGMENT,0),d=this.getFullCode(3,CodePiece.FRAGMENT,0),e=this.getFullCode(4,CodePiece.FRAGMENT,0),f=this.getFullCode(5,CodePiece.FRAGMENT,0),g=this.getFullCode(6,CodePiece.FRAGMENT,0),h=this.getFullCode(7,CodePiece.FRAGMENT,0),i=this.getFullCode(8,CodePiece.VERTEX,0),j=this.shader_piece.createShader(this.graph.scene_properties,a,b,c,d,e,f,g,h,i),k=this.graph.findNodesByType("texture/"+LGraphTexture.title),l=[],m=[],n=0;n<k.length;++n)l.push(k[n].properties.name);k=this.graph.findNodesByType("texture/"+LGraphCubemap.title);for(var n=0;n<k.length;++n)m.push(k[n].properties.name);j.cubemaps=m,j.textures=l,this.graph.shader_output=j},LiteGraph.registerNodeType("core/"+LGraphShader.title,LGraphShader),LGraphCompsToVec.title="CompsToVec",LGraphCompsToVec.desc="Components To Vector",LGraphCompsToVec.prototype.onExecute=function(){},LGraphCompsToVec.prototype.processInputCode=function(a){var b=0,c=this.getInputCode(0)||LiteGraph.EMPTY_CODE;b+=c.getOutputVar()?1:0;var d=this.getInputCode(1)||LiteGraph.EMPTY_CODE;b+=d.getOutputVar()?1:0;var e=this.getInputCode(2)||LiteGraph.EMPTY_CODE;b+=e.getOutputVar()?1:0;var f=this.getInputCode(3)||LiteGraph.EMPTY_CODE;b+=f.getOutputVar()?1:0;var g=2>b?"float":"vec"+b;this.shader_piece.setType(g);var h=this.codes[0]=this.shader_piece.getCode({out_var:g+"_"+this.id,a:this.valueToString(g,b,c.getOutputVar(),d.getOutputVar(),e.getOutputVar(),f.getOutputVar()),scope:a,order:this.order});h.merge(c),h.merge(d),h.merge(e),h.merge(f)},LGraphCompsToVec.prototype.valueToString=function(a,b){var c=Array.prototype.slice.call(arguments,2,2+parseInt(b)),d=c.join(",");return d=a+"("+d+")"},LGraphCompsToVec.prototype.onInputDisconnect=function(){this.output_array_index--,this.outputs[0].types={},this.outputs[0].types[""+this.output_array_types[this.output_array_index]]=1},LGraphCompsToVec.prototype.onInputConnect=function(){this.output_array_index++,this.outputs[0].types={},this.outputs[0].types[""+this.output_array_types[this.output_array_index]]=1},LiteGraph.registerNodeType("coordinates/"+LGraphCompsToVec.title,LGraphCompsToVec),LGraphTexturePreview.title="Preview",LGraphTexturePreview.desc="Show a texture in the graph canvas",LGraphTexturePreview.prototype.onDrawBackground=function(a){if(!this.flags.collapsed){var b=this.getInputData(0);if(b){var c=null;c=!b.handle&&a.webgl?b:LGraphTexture.generateLowResTexturePreview(b),a.save(),this.properties.flipY&&(a.translate(0,this.size[1]),a.scale(1,-1)),a.drawImage(c,0+.5*LiteGraph.NODE_COLLAPSED_RADIUS,0+.5*LiteGraph.NODE_COLLAPSED_RADIUS,this.size[0]-LiteGraph.NODE_COLLAPSED_RADIUS,this.size[1]-LiteGraph.NODE_COLLAPSED_RADIUS),a.restore()}}},window.LGraphTexturePreview=LGraphTexturePreview,LGraphTexture.title="TextureSample",LGraphTexture.desc="textureSample",LGraphTexture.widgets_info={name:{widget:"texture"}},LGraphTexture.textures_container={},LGraphTexture.loadTextureCallback=null,LGraphTexture.image_preview_size=256,LGraphTexture.PASS_THROUGH=1,LGraphTexture.COPY=2,LGraphTexture.LOW=3,LGraphTexture.HIGH=4,LGraphTexture.REUSE=5,LGraphTexture.DEFAULT=2,LGraphTexture.MODE_VALUES={"pass through":LGraphTexture.PASS_THROUGH,copy:LGraphTexture.COPY,low:LGraphTexture.LOW,high:LGraphTexture.HIGH,reuse:LGraphTexture.REUSE,"default":LGraphTexture.DEFAULT},LGraphTexture.getTexture=function(a,b){var c=gl.textures||LGraphTexture.textures_container;if(!c)throw"Cannot load texture, container of textures not found";var d=c[a];if(!d&&a&&":"!=a[0]||d&&1==d.width&&1==d.height&&d.texture_type!=gl.TEXTURE_CUBE_MAP){if(LGraphTexture.loadTextureCallback){var e=LGraphTexture.loadTextureCallback;return d=e(a,b)}var b=a;"http://"==b.substr(0,7)&&LiteGraph.proxy&&(b=LiteGraph.proxy+b.substr(7)),d=c[a]=GL.Texture.fromURL(a,{})}return d},LGraphTexture.getTargetTexture=function(a,b,c){if(!a)throw"LGraphTexture.getTargetTexture expects a reference texture";var d=null;switch(c){case LGraphTexture.LOW:d=gl.UNSIGNED_BYTE;break;case LGraphTexture.HIGH:d=gl.HIGH_PRECISION_FORMAT;break;case LGraphTexture.REUSE:return a;case LGraphTexture.COPY:default:d=a?a.type:gl.UNSIGNED_BYTE}return b&&b.width==a.width&&b.height==a.height&&b.type==d||(b=new GL.Texture(a.width,a.height,{type:d,format:gl.RGBA,filter:gl.LINEAR})),b},LGraphTexture.getNoiseTexture=function(){if(this._noise_texture)return this._noise_texture;for(var a=new Uint8Array(1048576),b=0;1048576>b;++b)a[b]=255*Math.random();var c=GL.Texture.fromMemory(512,512,a,{format:gl.RGBA,wrap:gl.REPEAT,filter:gl.NEAREST});return this._noise_texture=c,c},LGraphTexture.loadTextureFromFile=function(a,b,c,d,e){if(e=e||window.gl,a){var f=null,g=LiteGraph.removeExtension(b);if("string"==typeof a)e.textures[g]=f=GL.Texture.fromURL(a,{wrap:e.REPEAT},d,e);else if(-1!=b.toLowerCase().indexOf(".dds"))f=GL.Texture.fromDDSInMemory(a,e);else{var h=new Blob([c]),i=URL.createObjectURL(h);f=GL.Texture.fromURL(i,{},d,e)}return f.name=g,f}},LGraphTexture.prototype.toggleNormalMap=function(){this.options.normal_map_type.hidden="Normal map"==this.properties.texture_type?0:1},LGraphTexture.prototype.onDropFile=function(a,b,c,d,e){if(a){var f=LGraphTexture.loadTextureFromFile(a,b,c,LGraphTexture.configTexture,e);f&&(this._drop_texture=f,this._last_tex=this._drop_texture,this.properties.name=f.name,this._drop_texture.current_ctx=LiteGraph.current_ctx)}else this._drop_texture=null,this.properties.name=""},LGraphTexture.prototype.getExtraMenuOptions=function(){var a=this;if(this._drop_texture)return[{content:"Clear",callback:function(){a._drop_texture=null,a.properties.name=""}}]},LGraphTexture.prototype.onExecute=function(){if(this._drop_texture)return this._drop_texture.current_ctx!=LiteGraph.current_ctx&&(this._drop_texture=LGraphTexture.getTexture(this.properties.name,this.properties.texture_url)),void this.setOutputData(0,this._drop_texture);if(this.properties.name){var a=LGraphTexture.getTexture(this.properties.name,this.properties.texture_url);a&&(this._last_tex=a,this.setOutputData(0,a))}},LGraphTexture.prototype.onDrawBackground=function(a){if(!(this.flags.collapsed||this.size[1]<=20)){if(this._drop_texture&&a.webgl)return void a.drawImage(this._drop_texture,.05*this.size[1],.2*this.size[1],.75*this.size[0],.75*this.size[1]);if(this._last_preview_tex!=this._last_tex)if(a.webgl)this._canvas=this._last_tex;else if(!this._drop_texture&&!this._last_tex.hasOwnProperty("ready")||this._drop_texture&&!this._drop_texture.hasOwnProperty("ready")){var b=LGraphTexture.generateLowResTexturePreview(this._last_tex);if(!b)return;this._last_preview_tex=this._last_tex,this._canvas=cloneCanvas(b)}this._canvas&&(a.save(),a.webgl||(a.translate(0,this.size[1]),a.scale(1,-1)),a.drawImage(this._canvas,.05*this.size[1],.1*this.size[1],.75*this.size[0],.75*this.size[1]),a.restore())}},LGraphTexture.generateLowResTexturePreview=function(a){if(!a)return null;var b=LGraphTexture.image_preview_size,c=a;(a.width>b||a.height>b)&&(c=this._preview_temp_tex,this._preview_temp_tex||(c=new GL.Texture(b,b,{minFilter:gl.NEAREST}),this._preview_temp_tex=c),a.copyTo(c),a=c);var d=this._preview_canvas;return d||(d=createCanvas(b,b),this._preview_canvas=d),c&&c.toCanvas(d),d},LGraphTexture.prototype.processInputCode=function(a){var b=this.getInputCode(0)||this.onGetNullCode(0),c=0;if("Normal map"==this.properties.texture_type?"Tangent space"==this.properties.normal_map_type?c=LiteGraph.TANGENT_MAP:"Model space"==this.properties.normal_map_type?c=LiteGraph.NORMAL_MAP:"Bump map"==this.properties.normal_map_type&&(c=LiteGraph.BUMP_MAP):c=LiteGraph.COLOR_MAP,b){var d="u_"+(this.properties.name?this.properties.name:"default_name")+"_texture",e=this.codes[1]=this.shader_piece.getCode({out_var:"color_"+this.id,input:b.getOutputVar(),texture_id:d,texture_type:c,scope:a,order:this.order});e.merge(b);var f=e.clone();f.output_var=e.getOutputVar()+".r",this.codes[2]=f;var g=e.clone();g.output_var=e.getOutputVar()+".g",this.codes[3]=g;var h=e.clone();h.output_var=e.getOutputVar()+".b",this.codes[4]=h;var i=e.clone();i.output_var=e.getOutputVar()+".a",this.codes[5]=i}else this.codes[0]=LiteGraph.EMPTY_CODE,this.codes[1]=LiteGraph.EMPTY_CODE,this.codes[2]=LiteGraph.EMPTY_CODE,this.codes[3]=LiteGraph.EMPTY_CODE,this.codes[4]=LiteGraph.EMPTY_CODE,this.codes[5]=LiteGraph.EMPTY_CODE},LGraphTexture.prototype.onGetNullCode=function(a){if(0==a){var b=this.uvs_piece.getCode({order:this.order-1});return b}},LGraphTexture.loadTextureCallback=function(a,b){function c(a){LGraphTexture.configTexture(a),LiteGraph.dispatchEvent("graphCanvasChange",null,null)}return tex=gl.textures[a]=GL.Texture.fromURL(b,{},c),tex},LGraphTexture.configTexture=function(a){a.bind(),GL.isPowerOfTwo(a.width)&&GL.isPowerOfTwo(a.height)&&(gl.generateMipmap(a.texture_type),a.has_mipmaps=!0,a.minFilter=gl.LINEAR_MIPMAP_LINEAR,a.wrapS=gl.REPEAT,a.wrapT=gl.REPEAT),gl.texParameteri(a.texture_type,gl.TEXTURE_MIN_FILTER,a.minFilter),gl.texParameteri(a.texture_type,gl.TEXTURE_WRAP_S,a.wrapS),gl.texParameteri(a.texture_type,gl.TEXTURE_WRAP_T,a.wrapT),gl.bindTexture(a.texture_type,null)},LiteGraph.registerNodeType("texture/"+LGraphTexture.title,LGraphTexture),window.LGraphTexture=LGraphTexture,LGraphCubemap.title="TextureSampleCube",LGraphCubemap.desc="textureSampleCube",LGraphCubemap.prototype.onDropFile=function(a,b){if(a){var c=b.split(".")[0];gl.textures[c]=this._drop_texture="string"==typeof a?GL.Texture.cubemapFromURL(a):GL.Texture.fromDDSInMemory(a),this.properties.name=c}else this._drop_texture=null,this.properties.name=""},LGraphCubemap.prototype.onExecute=function(){if(this._drop_texture)return void this.setOutputData(0,this._drop_texture);if(this.properties.name){var a=LGraphTexture.getTexture(this.properties.name,this.properties.texture_url);
a&&(this._last_tex=a,this.setOutputData(0,a))}},LGraphCubemap.prototype.onDrawBackground=function(){},LGraphCubemap.prototype.processInputCode=function(a){var b=this.getInputCode(0)||this.onGetNullCode(0);if(b){var c="u_"+(this.properties.name?this.properties.name:"default_name")+"_texture",d=this.codes[1]=this.shader_piece.getCode({out_var:"color_"+this.id,input:b.getOutputVar(),texture_id:c,scope:a,order:this.order});d.merge(b)}else this.codes[0]=LiteGraph.EMPTY_CODE,this.codes[1]=LiteGraph.EMPTY_CODE},LGraphCubemap.prototype.onGetNullCode=function(a){if(0==a){var b=this.vector_piece.getCode({order:this.order-1});return b}},LiteGraph.registerNodeType("texture/"+LGraphCubemap.title,LGraphCubemap),window.LGraphCubemap=LGraphCubemap,LGraphVecToComps.title="VecToComps",LGraphVecToComps.desc="Vector To Components",LGraphVecToComps.prototype.onExecute=function(){},LGraphVecToComps.prototype.processInputCode=function(){var a=this.getInputCode(0);if(a){var b=a.clone();b.output_var=a.getOutputVar()+".x",this.codes[0]=b;var c=a.clone();c.output_var=a.getOutputVar()+".y",this.codes[1]=c;var d=a.clone();d.output_var=a.getOutputVar()+".z",this.codes[2]=d;var e=a.clone();e.output_var=a.getOutputVar()+".v",this.codes[3]=e}},LiteGraph.registerNodeType("coordinates/"+LGraphVecToComps.title,LGraphVecToComps),LGraphVecToVec.title="VecToVec",LGraphVecToVec.desc="VectorX To VectorY",LGraphVecToVec.prototype.onExecute=function(){},LGraphVecToVec.prototype.processInputCode=function(a){var b=this.getInputCode(0)||LiteGraph.EMPTY_CODE,c=this.codes[0]=this.shader_piece.getCode({out_var:"float_"+this.id,out_type:"float",in_type:this.getInputType(),a:b.getOutputVar(),scope:a,order:this.order});c.merge(b),c=this.codes[1]=this.shader_piece.getCode({out_var:"vec2_"+this.id,out_type:"vec2",in_type:this.getInputType(),a:b.getOutputVar(),scope:a,order:this.order}),c.merge(b),c=this.codes[2]=this.shader_piece.getCode({out_var:"vec3_"+this.id,out_type:"vec3",in_type:this.getInputType(),a:b.getOutputVar(),scope:a,order:this.order}),c.merge(b),c=this.codes[3]=this.shader_piece.getCode({out_var:"vec4_"+this.id,out_type:"vec4",in_type:this.getInputType(),a:b.getOutputVar(),scope:a,order:this.order}),c.merge(b)},LGraphVecToVec.prototype.getInputType=function(){var a=this.T_in_types,b=LiteGraph.getOtputTypeFromMap(a);return b},LiteGraph.registerNodeType("coordinates/"+LGraphVecToVec.title,LGraphVecToVec),LGraphAbs.prototype=Object.create(LGraph1ParamNode),LGraphAbs.prototype.constructor=LGraphAbs,LGraphAbs.title="Abs",LGraphAbs.desc="Abs of input",LiteGraph.extendClass(LGraphAbs,LGraph1ParamNode),LiteGraph.registerNodeType("math/"+LGraphAbs.title,LGraphAbs),LGraphCos.prototype=Object.create(LGraph1ParamNode),LGraphCos.prototype.constructor=LGraphCos,LGraphCos.title="Cos",LGraphCos.desc="cosine of input",LiteGraph.extendClass(LGraphCos,LGraph1ParamNode),LiteGraph.registerNodeType("math/"+LGraphCos.title,LGraphCos),LGraphExp.prototype=Object.create(LGraph1ParamNode),LGraphExp.prototype.constructor=LGraphExp,LGraphExp.title="Exp2",LGraphExp.desc="Exp of input",LiteGraph.extendClass(LGraphExp,LGraph1ParamNode),LiteGraph.registerNodeType("math/"+LGraphExp.title,LGraphExp),LGraphFrac.prototype=Object.create(LGraph1ParamNode),LGraphFrac.prototype.constructor=LGraphFrac,LGraphFrac.title="Fract",LGraphFrac.desc="fract of input",LiteGraph.extendClass(LGraphFrac,LGraph1ParamNode),LiteGraph.registerNodeType("math/"+LGraphFrac.title,LGraphFrac),LGraphSin.prototype=Object.create(LGraph1ParamNode),LGraphSin.prototype.constructor=LGraphSin,LGraphSin.title="Sin",LGraphSin.desc="sine of input",LiteGraph.extendClass(LGraphSin,LGraph1ParamNode),LiteGraph.registerNodeType("math/"+LGraphSin.title,LGraphSin),LGraphOperation.prototype=Object.create(LGraph2ParamNode),LGraphOperation.prototype.constructor=LGraphOperation,LGraphOperation.prototype.infereTypes=function(a,b,c){var d=c.getTypesFromOutputSlot(a);if("float"!=Object.keys(d)[0]){this.connectTemplateSlot();var e=this.inputs[b];if(e.use_t&&0===Object.keys(this.T_in_types).length){this.T_in_types["float"]=1;for(var f in d)this.T_in_types[f]=d[f];for(var f in d)this.T_out_types[f]=d[f]}}},LGraphOperation.prototype.onGetNullCode=function(a,b){if(0==a){var c=this.number_piece.getCode({out_var:"float_A"+this.id,a:this.properties.A.toFixed(3),scope:b,order:this.order-1});return c}if(1==a){var c=this.number_piece.getCode({out_var:"float_B"+this.id,a:this.properties.B.toFixed(3),scope:b,order:this.order-1});return c}},LGraphOperation.prototype.onDrawBackground=function(){this.inputs[0].label="A",this.isInputConnected(0)||(this.inputs[0].label+="="+this.properties.A.toFixed(3)),this.inputs[1].label="B",this.isInputConnected(1)||(this.inputs[1].label+="="+this.properties.B.toFixed(3))},LiteGraph.extendClass(LGraphOperation,LGraph2ParamNode),LGraphAddOp.prototype=Object.create(LGraphOperation),LGraphAddOp.prototype.constructor=LGraphAddOp,LGraphAddOp.title="Add",LGraphAddOp.desc="Add the inputs",LiteGraph.extendClass(LGraphAddOp,LGraphOperation),LiteGraph.registerNodeType("math/"+LGraphAddOp.title,LGraphAddOp),LGraphClamp.prototype=Object.create(LGraph3ParamNode),LGraphClamp.prototype.constructor=LGraphClamp,LGraphClamp.title="Clamp",LGraphClamp.desc="Clamp of input",LGraphClamp.prototype.onGetNullCode=function(a,b){if(1==a){var c=this.number_piece.getCode({out_var:"float_"+this.id+a,a:this.properties.min.toFixed(3),scope:b,order:this.order-1});return c}if(2==a){var c=this.number_piece.getCode({out_var:"float_"+this.id+a,a:this.properties.max.toFixed(3),scope:b,order:this.order-1});return c}return LiteGraph.EMPTY_CODE},LGraphClamp.prototype.onDrawBackground=function(){this.inputs[0].label="x",this.inputs[1].label="min",this.isInputConnected(1)||(this.inputs[1].label+="="+this.properties.min.toFixed(3)),this.inputs[2].label="max",this.isInputConnected(2)||(this.inputs[2].label+="="+this.properties.max.toFixed(3))},LiteGraph.extendClass(LGraphClamp,LGraph3ParamNode),LiteGraph.registerNodeType("math/"+LGraphClamp.title,LGraphClamp),LGraphDivOp.title="Div",LGraphDivOp.desc="div the inputs",LiteGraph.extendClass(LGraphDivOp,LGraphOperation),LiteGraph.registerNodeType("math/"+LGraphDivOp.title,LGraphDivOp),LGraphDot.title="Dot",LGraphDot.desc="Dot product the inputs",LiteGraph.extendClass(LGraphDot,LGraphOperation),LiteGraph.registerNodeType("math/"+LGraphDot.title,LGraphDot),LGraphFresnel.title="Fresnel",LGraphFresnel.desc="Fresnel the input",LGraphFresnel.prototype.onExecute=function(){},LGraphFresnel.prototype.processInputCode=function(a){var b=this.getInputCode(0)||LiteGraph.EMPTY_CODE,c=this.getInputCode(1)||LiteGraph.EMPTY_CODE,d=this.codes[0]=this.shader_piece.getCode({out_var:"fresnel_"+this.id,normal:b.getOutputVar(),exp:c.getOutputVar(),scope:a,order:this.order});b!=LiteGraph.EMPTY_CODE&&d.merge(b),d.merge(c)},LiteGraph.registerNodeType("math/"+LGraphFresnel.title,LGraphFresnel),LGraphIf.title="If",LGraphIf.desc="if between A and B",LGraphIf.prototype.onExecute=function(){},LGraphIf.prototype.processInputCode=function(a){var b=this.getInputCode(0)||LiteGraph.EMPTY_CODE,c=this.getInputCode(1)||LiteGraph.EMPTY_CODE,d=this.getInputCode(2)||LiteGraph.EMPTY_CODE,e=this.getInputCode(3)||LiteGraph.EMPTY_CODE,f=this.getInputCode(4)||LiteGraph.EMPTY_CODE;b.merge(c);var g=b.partialMerge(d),h=b.partialMerge(e),i=b.partialMerge(f),j=this.codes[0]=this.shader_piece.getCode({out_var:"if_"+this.id,out_type:this.getOutputType(),a:b.getOutputVar(),b:c.getOutputVar(),gt_out:d.getOutputVar(),lt_out:e.getOutputVar(),eq_out:f.getOutputVar(),gt:g[a-1],lt:h[a-1],eq:i[a-1],scope:a,order:this.order});j.merge(b)},LGraphIf.prototype.getOutputType=function(){var a=this.output_types?this.output_types:this.T_out_types,b=LiteGraph.getOtputTypeFromMap(a);return b},LiteGraph.registerNodeType("math/"+LGraphIf.title,LGraphIf),LGraphMix.prototype=Object.create(LGraph3ParamNode),LGraphMix.prototype.constructor=LGraphMix,LGraphMix.title="Mix",LGraphMix.desc="mix of input",LGraphMix.prototype.infereTypes=function(a,b,c){var d=c.getTypesFromOutputSlot(a);if(2!=b||"float"!=Object.keys(d)[0]){this.connectTemplateSlot();var e=this.inputs[b];if(e.use_t&&0===Object.keys(this.T_in_types).length){this.T_in_types["float"]=1;for(var f in d)this.T_in_types[f]=d[f];for(var f in d)this.T_out_types[f]=d[f]}}},LGraphMix.prototype.disconnectTemplateSlot=function(a){2!=a&&(this.in_conected_using_T>0&&this.in_conected_using_T--,this.resetTypes(a))},LGraphMix.prototype.onGetNullCode=function(a,b){if(2==a){var c=this.number_piece.getCode({out_var:"float_"+this.id,a:this.properties.alpha.toFixed(3),scope:b,order:this.order-1});return c}},LGraphMix.prototype.onDrawBackground=function(){this.inputs[2].label="alpha",this.isInputConnected(2)||(this.inputs[2].label+="="+this.properties.alpha.toFixed(3))},LiteGraph.extendClass(LGraphMix,LGraph3ParamNode),LiteGraph.registerNodeType("math/"+LGraphMix.title,LGraphMix),LGraphMulOp.title="Mul",LGraphMulOp.desc="Mul the inputs",LiteGraph.extendClass(LGraphMulOp,LGraphOperation),LiteGraph.registerNodeType("math/"+LGraphMulOp.title,LGraphMulOp),LGraphPanner.title="Panner",LGraphPanner.desc="Moves the input",LGraphPanner.prototype.onExecute=function(){},LGraphPanner.prototype.processInputCode=function(a){var b=this.getInputCode(0)||this.onGetNullCode(0,a),c=this.getInputCode(1)||LiteGraph.EMPTY_CODE,d=this.codes[0]=this.shader_piece.getCode({out_var:"panner_"+this.id,input:b.getOutputVar(),time:c.getOutputVar(),dx:this.properties.SpeedX.toFixed(3),dy:this.properties.SpeedY.toFixed(3),scope:a,out_type:"vec2",order:this.order});c!=LiteGraph.EMPTY_CODE&&d.merge(c),d.merge(b)},LGraphPanner.prototype.onGetNullCode=function(a){if(0==a){var b=this.uvs_piece.getCode({order:this.order-1});return b}},LiteGraph.registerNodeType("math/"+LGraphPanner.title,LGraphPanner),LGraphPow.title="Pow",LGraphPow.desc="Power of the input",LGraphPow.prototype.onDrawBackground=function(){this.inputs[0].label="Value",this.inputs[1].label="Exp",this.isInputConnected(0)||(this.inputs[0].label+="="+this.properties.A.toFixed(3)),this.isInputConnected(1)||(this.inputs[1].label+="="+this.properties.B.toFixed(3))},LiteGraph.extendClass(LGraphPow,LGraphOperation),LiteGraph.registerNodeType("math/"+LGraphPow.title,LGraphPow),LGraphReflect.title="Reflect",LGraphReflect.desc="To reflect a vector3",LGraphReflect.prototype.onExecute=function(){},LGraphReflect.prototype.processInputCode=function(){var a=this.getInputCode(0),b=this.getInputCode(1);if(b&&a){var c=this.codes[0]=this.shader_piece.getCode("reflect_"+this.id,b.getOutputVar(),a.getOutputVar(),CodePiece.FRAGMENT,"vec3");c.order=this.order,c.merge(a),c.merge(b)}else this.codes[0]=LiteGraph.EMPTY_CODE},LiteGraph.registerNodeType("math/"+LGraphReflect.title,LGraphReflect),LGraphSmooth.prototype=Object.create(LGraph3ParamNode),LGraphSmooth.prototype.constructor=LGraphSmooth,LGraphSmooth.title="SmoothStep",LGraphSmooth.desc="smoothstep of input",LGraphSmooth.prototype.infereTypes=function(a,b,c){var d=c.getTypesFromOutputSlot(a);if(0!=b&&1!=b||"float"!=Object.keys(d)[0]){this.connectTemplateSlot();var e=this.inputs[b];if(e.use_t&&0===Object.keys(this.T_in_types).length){this.T_in_types["float"]=1;for(var f in d)this.T_in_types[f]=d[f];for(var f in d)this.T_out_types[f]=d[f]}}},LGraphMix.prototype.disconnectTemplateSlot=function(a){0!=a&&1!=a&&(this.in_conected_using_T>0&&this.in_conected_using_T--,this.resetTypes(a))},LGraphSmooth.prototype.onGetNullCode=function(a,b){if(0==a){var c=this.number_piece.getCode({out_var:"float_"+this.id+a,a:this.properties.lower.toFixed(3),scope:b,order:this.order-1});return c}if(1==a){var c=this.number_piece.getCode({out_var:"float_"+this.id+a,a:this.properties.upper.toFixed(3),scope:b,order:this.order-1});return c}return LiteGraph.EMPTY_CODE},LGraphSmooth.prototype.onDrawBackground=function(){this.inputs[0].label="lower",this.isInputConnected(0)||(this.inputs[0].label+="="+this.properties.lower.toFixed(3)),this.inputs[1].label="upper",this.isInputConnected(1)||(this.inputs[1].label+="="+this.properties.upper.toFixed(3))},LiteGraph.extendClass(LGraphSmooth,LGraph3ParamNode),LiteGraph.registerNodeType("math/"+LGraphSmooth.title,LGraphSmooth),LGraphSubOp.prototype=Object.create(LGraphOperation),LGraphSubOp.prototype.constructor=LGraphSubOp,LGraphSubOp.title="Sub",LGraphSubOp.desc="Substraction of the inputs",LiteGraph.extendClass(LGraphSubOp,LGraphOperation),LiteGraph.registerNodeType("math/"+LGraphSubOp.title,LGraphSubOp);